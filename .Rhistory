summary.melt<-ddply(melt, .(hours_since_deployment, variable), summarize,
N=length(value),
mean=mean(value),
sd   = sd(value),
se   = sd / sqrt(N) )
ggplot(summary.melt, aes(x=hours_since_deployment, y=mean, fill=variable))+
ggtitle("August 2016")+
geom_point()+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se, alpha=1/2))+
geom_line(size=1)+
xlab("\nHours Since Deployment")+
ylab("Surviving\n")+
theme_few()+
guides(alpha=FALSE)+
theme(text = element_text(size=14))+
ylim(0,1)+
scale_x_continuous(expand = c(0, 0), limits = c(0, 75), breaks=c(0, 10, 20, 30, 40, 50, 60, 70))
ggsave('ggplotsurvivalbyexclosureAug2016.png', width=5, height=4)
##trying a lattice plot
library(lattice)
lattice<-xyplot(surviving ~ hours_since_deployment | block:treatment, data = data2, type = c("p", "r"),
main="August 2016")
lattice
stop(result_gls)
step(result_gls)
##error bar plots
cols <- c("corn" = "gold2", "prairie" = "yellowgreen", "soy" = "mediumpurple", "bare" = "firebrick1", "turf" ="dodgerblue2" )
ggplot.eb.open<- ggplot(data2.summary,
aes(x=hours_since_deployment, y=mean, shape=treatment, colour=treatment, fill=treatment))+
geom_point()+
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), colour="black", width=.2, position="dodge")+
scale_colour_manual(values=cols)+
scale_fill_manual(values=cols)+
geom_line(size=1)+
theme_bw()+
scale_x_continuous(expand = c(0, 0), limits = c(0, 75), breaks=c(0, 10, 20, 30, 40, 50, 60, 70))+
scale_y_continuous(expand = c(0, 0), limits = c(0, 1))+
xlab("")+
ylab("")+
theme_few()
ggsave('ggplot.eb.open_aug_2016.png', width=4, height=2)
ggplot.eb.open
ggplot.eb.closed<- ggplot(data2.summary.closed,
aes(x=hours_since_deployment, y=mean, shape=treatment, colour=treatment, fill=treatment))+
geom_point()+
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), colour="black", width=.2, position="dodge")+
scale_colour_manual(values=cols)+
scale_fill_manual(values=cols)+
geom_line(size=1)+
theme_bw()+
theme(text = element_text(size=14))+
scale_x_continuous(expand = c(0, 0), limits = c(0, 75), breaks=c(0, 10, 20, 30, 40, 50, 60, 70))+
scale_y_continuous(expand = c(0, 0), limits = c(0, 1))+
xlab("")+
ylab("")+
theme_few()
ggsave('ggplot.eb.closed_aug_2016.png', width=4, height=2)
ggplot.eb.closed
ggplot.eb.sham<- ggplot(data2.summary.sham,
aes(x=hours_since_deployment, y=mean, shape=treatment, colour=treatment, fill=treatment))+
geom_point()+
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), colour="black", width=.2, position="dodge")+
scale_colour_manual(values=cols)+
scale_fill_manual(values=cols)+
geom_line(size=1)+
theme(text = element_text(size=14))+
theme_bw()+
scale_x_continuous(expand = c(0, 0), limits = c(0, 75), breaks=c(0, 10, 20, 30, 40, 50, 60, 70))+
scale_y_continuous(expand = c(0, 0), limits = c(0, 1))+
xlab("")+
ylab("")+
theme_few()
ggsave('ggplot.eb.sham_aug_2016.png', width=4, height=2)
ggplot.eb.sham
#ribbon plots
cols <- c("corn" = "gold2", "prairie" = "limegreen", "soy" = "mediumpurple", "bare" = "firebrick1", "turf" ="dodgerblue2" )
ggplot.open<- ggplot(data2.summary,
aes(x=hours_since_deployment, y=mean, shape=treatment, colour=treatment, fill=treatment))+
geom_point()+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se, alpha=1/2))+
scale_colour_manual(values=cols)+
scale_fill_manual(values=cols)+
geom_line(size=1.5)+
xlab("Hours Since Deployment")+
ylab("Surviving")+
scale_x_continuous(expand = c(0, 0), limits = c(0, 75), breaks=c(0, 10, 20, 30, 40, 50, 60, 70))
ggplot.open
ggplot.closed<- ggplot(data2.summary.closed,
aes(x=hours_since_deployment, y=mean, shape=treatment, colour=treatment, fill=treatment))+
geom_point()+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se, alpha=1/2))+
scale_colour_manual(values=cols)+
scale_fill_manual(values=cols)+
geom_line(size=1.5)+
xlab("Hours Since Deployment")+
ylab("Surviving")+
theme(text = element_text(size=14))+
scale_x_continuous(expand = c(0, 0), limits = c(0, 75), breaks=c(0, 10, 20, 30, 40, 50, 60, 70))
ggplot.closed
ggplot.sham<- ggplot(data2.summary.sham,
aes(x=hours_since_deployment, y=mean, shape=treatment, colour=treatment, fill=treatment))+
geom_point()+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se, alpha=1/2))+
scale_colour_manual(values=cols)+
scale_fill_manual(values=cols)+
geom_line(size=1.5)+
xlab("Hours Since Deployment")+
ylab("Surviving")+
theme(text = element_text(size=14))+
scale_x_continuous(expand = c(0, 0), limits = c(0, 75), breaks=c(0, 10, 20, 30, 40, 50, 60, 70))
ggplot.sham
##more plotting, making chart for comparing among exlcosure treatments
melt<-melt(data2, measure.vars = c("surviving", "closed", "sham"))
summary.melt<-ddply(melt, .(hours_since_deployment, variable), summarize,
N=length(value),
mean=mean(value),
sd   = sd(value),
se   = sd / sqrt(N) )
ggplot(summary.melt, aes(x=hours_since_deployment, y=mean, fill=variable))+
ggtitle("August 2016")+
geom_point()+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se, alpha=1/2))+
geom_line(size=1)+
xlab("\nHours Since Deployment")+
ylab("Surviving\n")+
theme_few()+
guides(alpha=FALSE)+
theme(text = element_text(size=14))+
ylim(0,1)+
scale_x_continuous(expand = c(0, 0), limits = c(0, 75), breaks=c(0, 10, 20, 30, 40, 50, 60, 70))
ggsave('ggplotsurvivalbyexclosureAug2016.png', width=5, height=4)
View(data2.summary.closed)
# Load packages
library(glmmADMB)
library(bbmle)
library(arm)
library(lme4)
library(piecewiseSEM)
library(ggplot2)
#bring data in
data_aug2016<-read.csv(file="deployment2_2016_notsmooth_csv.csv", header=TRUE)
#make a plant patch column called 'patch'
data_aug2016<-within(data_aug2016, patch <- paste(block,treatment,exclosure_treatment, sep ='.'))
data_aug2016<-within(data_aug2016, surviving <- (total_all_stages/initial_count))
#drop turf and all but 72 hr obs
data_aug2016_3day <- data_aug2016[ which(data_aug2016$hours_since_deployment == 71 & data_aug2016$treatment != 'turf'), ]
#####day3 survival###### eggs and caterpillars coming back to life not corrected#######
m0 = glmer(cbind(total_all_stages, initial_count) ~
1 + (1|patch), family=binomial(), data=data_aug2016_3day)
m1 = glmer(cbind(total_all_stages, initial_count) ~
treatment + (1|patch), family=binomial(), data=data_aug2016_3day)
m2 = glmer(cbind(total_all_stages, initial_count) ~
exclosure_treatment + (1|patch), family=binomial(), data=data_aug2016_3day)
m3 = glmer(cbind(total_all_stages, initial_count) ~
treatment + exclosure_treatment + (1|patch), family=binomial(), data=data_aug2016_3day)
m4 = glmer(cbind(total_all_stages, initial_count) ~
treatment*exclosure_treatment + (1|patch), family=binomial(), data=data_aug2016_3day)
# check out AICc values (from pkg bbmle)
AICctab(m0, m1)
# Do plant treatments influence survival?
anova(m0, m1)
# Do exclosures treatments influence survival?
anova(m0, m2)
# Do habitat treatments and exclosure treatments both independently or interactively influence?
anova(m0, m1, m3, m4)
anova(m0, m2, m3, m4)
anova(m2, m4)
anova(m0, m4) #significance of interaction/fullmodel
summary(m4)
# Plotting
# FIGURE 1a
display(m4)
summary(m4)
o = sim(m4, n.sims=10000)
colMeans(fixef(o))
m4.CI = data.frame(
x = rep(c('bare', 'corn', 'prairie', 'soy'),4),
exclosure_treatment = rep(c('closed', 'open', 'sham'), each=4),
coefs = c(plogis( mean( o@fixef[,1] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,3] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,4] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6] ) )
),
lower = c(plogis( quantile( o@fixef[,1], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.025 ) )
),
upper = c(plogis( quantile( o@fixef[,1], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.975 ) )
)
)
# effect sizes:
(m4.CI$coefs[2]-m4.CI$coefs[1]) / m4.CI$coefs[1]
(m4.CI$coefs[3]-m4.CI$coefs[1]) / m4.CI$coefs[1]
##make the figure
cols <- c("corn" = "gold2", "prairie" = "yellowgreen", "soy" = "mediumpurple", "bare" = "firebrick1", "turf" ="dodgerblue2" )
fig1a = ggplot(data_aug2016_3day, aes(x = treatment, y = total_all_stages/initial_count, colour = treatment))+
geom_point(alpha=0.5, position = position_jitter(width=0.05, height=0.01)) +
scale_color_manual(values=cols)+
facet_grid(.~exclosure_treatment) +
labs(x = 'habitat treatment', y = 'survival') +
geom_pointrange(data=m4.CI, aes(x = x, y = coefs, ymin=lower, ymax=upper),
col = 1, size=0.5, position = position_nudge(x = -0.35), alpha=1)
fig1a
install.packages("glmmADMB")
install.packages("bbmle")
install.packages("arm")
install.packages("piecewiseSEM")
# Load packages
library(glmmADMB)
library(bbmle)
library(arm)
library(lme4)
library(piecewiseSEM)
library(ggplot2)
#bring data in
data_aug2016<-read.csv(file="deployment2_2016_notsmooth_csv.csv", header=TRUE)
#make a plant patch column called 'patch'
data_aug2016<-within(data_aug2016, patch <- paste(block,treatment,exclosure_treatment, sep ='.'))
data_aug2016<-within(data_aug2016, surviving <- (total_all_stages/initial_count))
#drop turf and all but 72 hr obs
data_aug2016_3day <- data_aug2016[ which(data_aug2016$hours_since_deployment == 71 & data_aug2016$treatment != 'turf'), ]
drop turf and all but 72 hr obs
data_aug2016_3day <- data_aug2016[ which(data_aug2016$hours_since_deployment == 71 & data_aug2016$treatment != 'turf'), ]
#####day3 survival###### eggs and caterpillars coming back to life not corrected#######
m0 = glmer(cbind(total_all_stages, initial_count) ~
1 + (1|patch), family=binomial(), data=data_aug2016_3day)
m1 = glmer(cbind(total_all_stages, initial_count) ~
treatment + (1|patch), family=binomial(), data=data_aug2016_3day)
m2 = glmer(cbind(total_all_stages, initial_count) ~
exclosure_treatment + (1|patch), family=binomial(), data=data_aug2016_3day)
m3 = glmer(cbind(total_all_stages, initial_count) ~
treatment + exclosure_treatment + (1|patch), family=binomial(), data=data_aug2016_3day)
m4 = glmer(cbind(total_all_stages, initial_count) ~
treatment*exclosure_treatment + (1|patch), family=binomial(), data=data_aug2016_3day)
# check out AICc values (from pkg bbmle)
AICctab(m0, m1)
# Do plant treatments influence survival?
anova(m0, m1)
# Do exclosures treatments influence survival?
anova(m0, m2)
# Do habitat treatments and exclosure treatments both independently or interactively influence?
anova(m0, m1, m3, m4)
anova(m0, m2, m3, m4)
anova(m2, m4)
anova(m0, m4) #significance of interaction/fullmodel
summary(m4)
# Plotting
# FIGURE 1a
display(m4)
summary(m4)
o = sim(m4, n.sims=10000)
colMeans(fixef(o))
m4.CI = data.frame(
x = rep(c('bare', 'corn', 'prairie', 'soy'),4),
exclosure_treatment = rep(c('closed', 'open', 'sham'), each=4),
coefs = c(plogis( mean( o@fixef[,1] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,3] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,4] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6] ) )
),
lower = c(plogis( quantile( o@fixef[,1], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.025 ) )
),
upper = c(plogis( quantile( o@fixef[,1], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.975 ) )
)
)
# effect sizes:
(m4.CI$coefs[2]-m4.CI$coefs[1]) / m4.CI$coefs[1]
(m4.CI$coefs[3]-m4.CI$coefs[1]) / m4.CI$coefs[1]
##make the figure
cols <- c("corn" = "gold2", "prairie" = "yellowgreen", "soy" = "mediumpurple", "bare" = "firebrick1", "turf" ="dodgerblue2" )
fig1a = ggplot(data_aug2016_3day, aes(x = treatment, y = total_all_stages/initial_count, colour = treatment))+
geom_point(alpha=0.5, position = position_jitter(width=0.05, height=0.01)) +
scale_color_manual(values=cols)+
facet_grid(.~exclosure_treatment) +
labs(x = 'habitat treatment', y = 'survival') +
geom_pointrange(data=m4.CI, aes(x = x, y = coefs, ymin=lower, ymax=upper),
col = 1, size=0.5, position = position_nudge(x = -0.35), alpha=1)
fig1a
# Plotting
# FIGURE 1a
display(m4)
summary(m4)
o = sim(m4, n.sims=10000)
colMeans(fixef(o))
m4.CI = data.frame(
x = rep(c('bare', 'corn', 'prairie', 'soy'),4),
exclosure_treatment = rep(c('closed', 'open', 'sham'), each=4),
coefs = c(plogis( mean( o@fixef[,1] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,3] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,4] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6] ) )
),
lower = c(plogis( quantile( o@fixef[,1], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.025 ) )
),
upper = c(plogis( quantile( o@fixef[,1], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.975 ) )
)
)
# effect sizes:
(m4.CI$coefs[2]-m4.CI$coefs[1]) / m4.CI$coefs[1]
(m4.CI$coefs[3]-m4.CI$coefs[1]) / m4.CI$coefs[1]
##make the figure
cols <- c("corn" = "gold2", "prairie" = "yellowgreen", "soy" = "mediumpurple", "bare" = "firebrick1", "turf" ="dodgerblue2" )
fig1a = ggplot(data_aug2016_3day, aes(x = treatment, y = total_all_stages/initial_count, colour = treatment))+
geom_point(alpha=0.5, position = position_jitter(width=0.05, height=0.01)) +
scale_color_manual(values=cols)+
facet_grid(.~exclosure_treatment) +
labs(x = 'habitat treatment', y = 'survival') +
geom_pointrange(data=m4.CI, aes(x = x, y = coefs, ymin=lower, ymax=upper),
col = 1, size=0.5, position = position_nudge(x = -0.35), alpha=1)
fig1a
# Plotting
# FIGURE 1a
display(m4)
summary(m4)
o = sim(m4, n.sims=10000)
colMeans(fixef(o))
m4.CI = data.frame(
x = rep(c('bare', 'corn', 'prairie', 'soy'),4),
exclosure_treatment = rep(c('closed', 'open', 'sham'), each=4),
coefs = c(plogis( mean( o@fixef[,1] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,3] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,4] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6] ) )
),
lower = c(plogis( quantile( o@fixef[,1], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.025 ) )
),
upper = c(plogis( quantile( o@fixef[,1], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.975 ) )
)
)
# effect sizes:
(m4.CI$coefs[2]-m4.CI$coefs[1]) / m4.CI$coefs[1]
(m4.CI$coefs[3]-m4.CI$coefs[1]) / m4.CI$coefs[1]
##make the figure
cols <- c("corn" = "gold2", "prairie" = "yellowgreen", "soy" = "mediumpurple", "bare" = "firebrick1", "turf" ="dodgerblue2" )
fig1a = ggplot(data_aug2016_3day, aes(x = treatment, y = total_all_stages/initial_count, colour = treatment))+
geom_point(alpha=0.5, position = position_jitter(width=0.05, height=0.01)) +
scale_color_manual(values=cols)+
facet_grid(.~exclosure_treatment) +
labs(x = 'habitat treatment', y = 'survival') +
geom_pointrange(data=m4.CI, aes(x = x, y = coefs, ymin=lower, ymax=upper),
col = 1, size=0.5, position = position_nudge(x = -0.35), alpha=1)
fig1a
fig1a
m4.CI = data.frame(
x = rep(c('bare', 'corn', 'prairie', 'soy'),4),
exclosure_treatment = rep(c('closed', 'open', 'sham'), each=4),
coefs = c(plogis( mean( o@fixef[,1] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,3] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,4] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6] ) )
),
lower = c(plogis( quantile( o@fixef[,1], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.025 ) )
),
upper = c(plogis( quantile( o@fixef[,1], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.975 ) )
)
)
# effect sizes:
(m4.CI$coefs[2]-m4.CI$coefs[1]) / m4.CI$coefs[1]
(m4.CI$coefs[3]-m4.CI$coefs[1]) / m4.CI$coefs[1]
m4.CI = data.frame(
x = rep(c('bare', 'corn', 'prairie', 'soy'),4),
exclosure_treatment = rep(c('closed', 'open', 'sham'), each=4),
coefs = c(plogis( mean( o@fixef[,1] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,3] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,4] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6] ) )
),
lower = c(plogis( quantile( o@fixef[,1], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.025 ) )
),
upper = c(plogis( quantile( o@fixef[,1], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.975 ) )
)
)
display(m4)
summary(m4)
o = sim(m4, n.sims=10000)
colMeans(fixef(o))
m4.CI = data.frame(
x = rep(c('bare', 'corn', 'prairie', 'soy'), 4),
exclosure_treatment = rep(c('closed', 'open', 'sham'), each=3),
coefs = c(plogis( mean( o@fixef[,1] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,3] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,4] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6] ) )
),
lower = c(plogis( quantile( o@fixef[,1], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.025 ) )
),
upper = c(plogis( quantile( o@fixef[,1], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.975 ) )
)
)
# effect sizes:
(m4.CI$coefs[2]-m4.CI$coefs[1]) / m4.CI$coefs[1]
(m4.CI$coefs[3]-m4.CI$coefs[1]) / m4.CI$coefs[1]
?reos
?reps
?rep
X
m4.CI = data.frame(
x = rep(c('bare', 'corn', 'prairie', 'soy'), 4),
exclosure_treatment = rep(c('closed', 'open', 'sham'), each=4),
coefs = c(plogis( mean( o@fixef[,1] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,3] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,4] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5] ) ),
plogis( mean( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6] ) )
),
lower = c(plogis( quantile( o@fixef[,1], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.025 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.025 ) )
),
upper = c(plogis( quantile( o@fixef[,1], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,3], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,4], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,3] + o@fixef[,5], 0.975 ) ),
plogis( quantile( o@fixef[,1] + o@fixef[,2] + o@fixef[,4] + o@fixef[,6], 0.975 ) )
)
)
##make the figure
cols <- c("corn" = "gold2", "prairie" = "yellowgreen", "soy" = "mediumpurple", "bare" = "firebrick1", "turf" ="dodgerblue2" )
fig1a = ggplot(data_aug2016_3day, aes(x = treatment, y = total_all_stages/initial_count, colour = treatment))+
geom_point(alpha=0.5, position = position_jitter(width=0.05, height=0.01)) +
scale_color_manual(values=cols)+
facet_grid(.~exclosure_treatment) +
labs(x = 'habitat treatment', y = 'survival')
fig1a
o
